# Use eth2 IP as the OVN Geneve encap IP on each node
images:
  tags:
    # Use upstream OVN images that are built on Ubuntu 22.04 (glibc ≥ 2.35)
    ovn_ovsdb_nb:      quay.io/ovn-org/ovn:24.03.0-ubuntu22.04
    ovn_ovsdb_sb:      quay.io/ovn-org/ovn:24.03.0-ubuntu22.04
    ovn_northd:        quay.io/ovn-org/ovn:24.03.0-ubuntu22.04
    ovn_controller:    quay.io/ovn-org/ovn:24.03.0-ubuntu22.04

    # All helper/entrypoint images must match the glibc era too
    dep_check:         quay.io/airshipit/kubernetes-entrypoint:latest-ubuntu_jammy
    db_init:           quay.io/airshipit/kubernetes-entrypoint:latest-ubuntu_jammy   # if your chart has this
    ovn_controller_kubectl: docker.io/openstackhelm/ceph-config-helper:latest-ubuntu_jammy

    # keep parser/vector on a modern base (noble/debian12 are fine)
    ovn_logging_parser: docker.io/openstackhelm/neutron:2025.1-ubuntu_noble
    vector:            docker.io/timberio/vector:0.39.0-debian

network:
  interface:
    tunnel: eth2            # chart derives ovn-encap-ip from this
  external:
    bridge:
      name: br-ex
    interface: eth1         # enslave eth1 into br-ex for provider nets

labels:
  ovn_ovsdb_nb:
    node_selector_key: openstack-network-node
    node_selector_value: enabled
  ovn_ovsdb_sb:
    node_selector_key: openstack-network-node
    node_selector_value: enabled
  ovn_northd:
    node_selector_key: openstack-network-node
    node_selector_value: enabled
  ovn_controller:
    node_selector_key: openvswitch
    node_selector_value: enabled
  ovn_controller_gw:
    node_selector_key: l3-agent
    node_selector_value: enabled

conf:
  ovn:
    # Bridge→physnet mapping for provider networks
    # The infra chart will program:
    #   - external-ids:ovn-bridge-mappings=physnet1:br-ex
    #   - external-ids:ovn-encap-type=geneve
    #   - external-ids:ovn-encap-ip=<IP on eth2>
    bridge_mappings: "physnet1:br-ex"
    bridge_interface_mappings: "br-ex:eth1"

  # Optional: set MTU for Geneve overlay
  mtu:
    geneve: 1450

manifests:
  # Central components
  deployment_ovn_northd: true
  statefulset_ovn_nb_db: true
  statefulset_ovn_sb_db: true
  service_ovn_nb: true
  service_ovn_sb: true

  # Controllers on all (compute+controller) nodes
  daemonset_ovn_controller: true

