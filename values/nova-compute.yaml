helm3_hook: false

pod:
  replicas:
    api: 1
    conductor: 1
    scheduler: 1
    novncproxy: 1
  env:
    nova:
      NOVA_SCHEDULER:
        - name: RPC_PROBE_TIMEOUT
          value: "180"
        - name: RPC_PROBE_RETRIES
          value: "5"
      NOVA_CONDUCTOR:
        - name: RPC_PROBE_TIMEOUT
          value: "180"
        - name: RPC_PROBE_RETRIES
          value: "5"
manifests:
  ingress_api: false
  ingress_novncproxy: false
  secret_rabbitmq: true 
  job_db_init: true
  job_db_sync: true
  job_rabbit_init: true
  job_ks_user: true
  job_ks_service: true
  job_ks_endpoints: true
  job_storage_init: true
  secret_db: true
  secret_db_api: true
  secret_db_cell0: true
  secret_keystone: true
  secret_rabbitmq: true
  secret_ks_etc: true
endpoints:
  identity:
    hosts:
      default: keystone-api
      internal: keystone-api
    namespace: openstack
    port:
      api:
        default: 80
        internal: 5000
    scheme:
      default: http
    path:
      default: /v3
    auth:
      admin:
        region_name: RegionOne
        username: admin
        project_name: admin
        user_domain_name: Default
        project_domain_name: Default
      nova:
        role: admin,service
        region_name: RegionOne
        username: nova
        project_name: service
        user_domain_name: Default
        project_domain_name: Default
      service:
        role: admin,service
        region_name: RegionOne
        username: nova_service_user
        project_name: service
        user_domain_name: Default
        project_domain_name: Default
      neutron:
        role: admin,service
        region_name: RegionOne
        project_name: service
        user_domain_name: Default
        project_domain_name: Default
        username: nova_neutron
      ironic:
        role: admin,service
        auth_type: password
        auth_version: v3
        region_name: RegionOne
        project_name: service
        user_domain_name: Default
        project_domain_name: Default
        username: nova_ironic
      placement:
        role: admin,service
        region_name: RegionOne
        username: nova_placement
        project_name: service
        user_domain_name: Default
        project_domain_name: Default
      cinder:
        role: admin,service
        region_name: RegionOne
        username: nova_cinder
        project_name: service
        user_domain_name: Default
        project_domain_name: Default
      test:
        role: admin
        region_name: RegionOne
        username: nova-test
        project_name: test
        user_domain_name: Default
        project_domain_name: Default

  placement:
    hosts:
      default: placement-api
    namespace: openstack
    port:
      api:
        default: 8778
        public: 80
        service: 8778
    scheme:
      default: http
      service: http
    path:
      default: /
    auth:
      nova:
        region_name: RegionOne

  oslo_messaging:
    statefulset: null
    host_fqdn_overrides:
      default: rabbitmq.osh-infra.svc.cluster.local
    hosts:
      default: rabbitmq
    namespace: osh-infra
    scheme:
      default: rabbit
    port:
      amqp:
        default: 5672
      http:
        default: 15672
    path:
      default: /nova
    auth:
      admin:
        username: rabbitmq
      nova:
        username: nova

  oslo_cache:
    hosts:
      default: memcached
    namespace: osh-infra
    port:
      memcache:
        default: 11211

  oslo_db:
    hosts:
      default: mariadb
    namespace: osh-infra
    scheme: mysql+pymysql
    path: /nova
    port:
      mysql:
        default: 3306
    auth:
      admin: { username: root }
      nova:  { username: nova }
      api:   { username: nova_api }
      cell0: { username: nova_cell0 }
      cell1: { username: nova_cell1 }

  oslo_db_api:
    hosts: { default: mariadb }
    namespace: osh-infra
    path: /nova_api
    scheme: mysql+pymysql
    port: { mysql: { default: 3306 } }
    auth:
      admin: { username: root }
      nova:  { username: nova }

  oslo_db_cell0:
    hosts: { default: mariadb }
    namespace: osh-infra
    path: /nova_cell0
    scheme: mysql+pymysql
    port: { mysql: { default: 3306 } }
    auth:
      admin: { username: root }
      nova:  { username: nova } 
conf:
  nova:
    DEFAULT:
      debug: true
      transport_url: ""
    libvirt:
      virt_type: kvm
  ceph:
    enabled: true
  ceph_client:
    configmap: ceph-etc
    user_secret_name: pvc-ceph-client-key 
  logging:
    loggers:
      keys: root,nova,oslo_messaging,amqp
    logger_root:
      level: INFO
      handlers: stdout
    logger_nova:
      level: DEBUG
      handlers: stdout
      qualname: nova
    logger_oslo_messaging:
      level: INFO
      handlers: stdout
      qualname: oslo_messaging
    logger_amqp:
      level: INFO
      handlers: stdout
      qualname: amqp
dependencies:
  dynamic:
    pod:
      - type: pod
        required: true
        same_host: true
        namespace: osh-infra
        labels:
          application: libvirt
          component: libvirt
      - type: pod
        required: false
        same_host: true
        namespace: openstack
        labels:
          application: neutron
          component: neutron-ovs-agent
    service:
      - type: service
        required: false
        namespace: openstack
        name: glance-api
      - type: service
        required: false
        namespace: openstack
        name: neutron-server
